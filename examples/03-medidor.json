{
    "project" : "03-Medidor de Agua",
    "code" : "TQ1000102",
    "interfaces" : [
        {   
            "interface" : "app",
            "type" : "app"
        },
        {
            "interface" : "dut",
            "type" : "tty",
            "defaultPortName" : "COM4",
            "baudRate" : 9600,
            "dataBits" : 8,
            "parity" : 0,
            "stopBits" : 1
        },
        {
            "interface" : "pickit",
            "type" : "usb",
            "bur" : "BUR160872187",
            "target" : "PIC24FJ128GA310",
            "mclrPin" : "TP1",
            "vccPin" : "TP29",
            "gndPin" : "TP28",
            "pgdPin" : "TP3",
            "pgcPin" : "TP2"
        }
    ],
    "ipeConfigs" : {
        "ipePath" : "C:/Program Files (x86)/Microchip/MPLABX/v5.10/mplab_platform/mplab_ipe/ipecmd.exe",
        "hexPath" : "D:/Owncloud/ProyectosElectronicos/TQ0003-MedidorAgua/10-Entregables/fw/MedidorAgua_ProduccionVaritronix_v1.0.1_181129.hex"
    },
    "commands": [
        {
            "tool": "app",
            "command": "openInterface",
            "parameter": "dut",
            "messageOnErr": "No es posible abrir la interfaz de comunicación con el medidor",
            "end": true,
            "timeout": 500,
            "enabled": true,
            "ifCodeName": "Abre comunicación con medidor",
            "id": "openDut",
            "description": "Abre la interfaz de comunicación con el medidor"
        },
        {
            "tool": "pickit",
            "command": "program",
            "end": true,
            "timeout": 60000,
            "enabled": true,
            "ifCodeName": "Programar firmware",
            "id": "program",
            "description": "Comando para realizar la programación del firmware"
        },
        {
            "tool": "app",
            "command": "delay",
            "timeout": 5000,
            "enabled": true,
            "ifCodeName": "Demora 3 segundos",
            "id": "program",
            "description": "Demora de 3 segundos"
        },
        {
            "tool": "dut",
            "command": "usartXfer",
            "txCommand": "id",
            "rxParameter": "tsi1",
            "onOk": "0",
            "onErr": "1",
            "messageOnOk": "El medidor fue identificado",
            "messageOnErr": "No fue posible identificar el medidor",
            "retry": true,
            "end": true,
            "timeout": 3000,
            "enabled": true,
            "ifCodeName": "Identificar medidor",
            "id": "idTsi",
            "description": "Comando id para identificación del medidor"
        },
        {
            "tool": "dut",
            "command": "usartXfer",
            "txCommand": "fmode",
            "onOk": "0",
            "onErr": "1",
            "messageOnOk": "Ingresando a modo fábrica",
            "messageOnErr": "No fue posible ingresar a modo fábrica",
            "retry": true,
            "end": true,
            "timeout": 3000,
            "enabled": true,
            "ifCodeName": "Modo fábrica",
            "id": "fmode",
            "description": "Comando fmode para ingresar al modo fábrica"
        },
        {
            "tool": "dut",
            "command": "usartXfer",
            "txCommand": "flerase",
            "onOk": "0",
            "onErr": "1",
            "messageOnOk": "La memoria del medidor fue borrada.",
            "messageOnErr": "No fue posble borrar la memoria del medidor",
            "retry": true,
            "end": true,
            "timeout": 3000,
            "enabled": true,
            "ifCodeName": "Borrar memoria",
            "id": "flerase",
            "description": "Comando flerase para borrar la memoria del medidor"
        },
        {
            "tool": "dut",
            "command": "usartXfer",
            "txCommand": "test_mem",
            "onOk": "0",
            "onErr": "1",
            "messageOnOk": "Prueba de memoria OK",
            "messageOnErr": "Prueba de memoria ERROR",
            "retry": true,
            "end": true,
            "timeout": 3000,
            "enabled": true,
            "ifCodeName": "Probar memoria",
            "id": "testMem",
            "description": "Comando test_mem para chequear la memoria del medidor"
        },
        {
            "tool": "dut",
            "command": "usartXfer",
            "txCommand": "test_valve",
            "txParameter": "1",
            "onOk": "0",
            "onErr": "1",
            "messageOnOk": "Activando el circuito de la válvula apertura/cierre",
            "retry": true,
            "end": false,
            "timeout": 3000,
            "enabled": true,
            "ifCodeName": "Abrir/Cerrar válvula",
            "id": "testValve1",
            "description": "Comando test_valve 1 para abrir/cerrar la válvula del medidor"
        },
        {
            "tool": "app",
            "command": "dialog",
            "parameter": "Revisar si el voltaje es correcto [-5V]",
            "messageOnOk": "El voltaje de la válvula marcó [-5V]",
            "messageOnErr": "El voltaje de la válvula no marcó [-5V]",
            "retry": false,
            "end": false,
            "timeout": 10000,
            "enabled": true,
            "ifCodeName": "Verificar voltaje de la válvula [-5V]",
            "id": "testValve-5V",
            "description": "Cuadro de dialogo que pide confirmación de la medición del voltaje de la válvula"
        },
        {
            "tool": "dut",
            "command": "usartXfer",
            "txCommand": "test_valve",
            "txParameter": "0",
            "onOk": "0",
            "onErr": "1",
            "messageOnOk": "Activando el circuito de la válvula cierre/apertura",
            "retry": true,
            "end": false,
            "timeout": 3000,
            "enabled": true,
            "ifCodeName": "Cerrar/Abrir válvula",
            "id": "testValve0",
            "description": "Comando test_valve 0 para abrir/cerrar la válvula del medidor"
        },
        {
            "tool": "app",
            "command": "dialog",
            "parameter": "Revisar si el voltaje es correcto [+5V]",
            "messageOnOk": "El voltaje de la válvula marcó [+5V]",
            "messageOnErr": "El voltaje de la válvula no marcó [+5V]",
            "retry": false,
            "end": false,
            "timeout": 10000,
            "enabled": true,
            "ifCodeName": "Verificar voltaje de la válvula [+5V]",
            "id": "testValve+5V",
            "description": "Cuadro de dialogo que pide confirmación de la medición del voltaje de la válvula"
        },
        {
            "tool": "dut",
            "command": "usartXfer",
            "txCommand": "setsn",
            "txParameter": "#serialNumber",
            "onOk": "0",
            "onErr": "1",
            "messageOnOk": "Enviado el número de serie del medidor",
            "messageOnErr": "No fue posible enviar el número de serie del medidor",
            "retry": true,
            "end": true,
            "timeout": 3000,
            "enabled": true,
            "ifCodeName": "Enviar número de serie",
            "id": "setsn",
            "description": "Envía el número de serie del medidor"
        },
        {
            "tool": "dut",
            "command": "usartXfer",
            "txCommand": "cnfgdef",
            "onOk": "0",
            "onErr": "1",
            "messageOnOk": "Configuración de fábrica por defecto OK",
            "messageOnErr": "Configuración de fábrica por defecto ERROR",
            "retry": true,
            "end": true,
            "timeout": 3000,
            "enabled": true,
            "ifCodeName": "Configurar parámetros de fábrica",
            "id": "configDef",
            "description": "Configuración por defecto del medidor"
        },
        {
            "tool": "dut",
            "command": "usartXfer",
            "txCommand": "snsrdef",
            "onOk": "0",
            "onErr": "1",
            "messageOnOk": "Configuración del sensor por defecto OK",
            "messageOnErr": "Configuración del sensor por defecto ERROR",
            "retry": true,
            "end": true,
            "timeout": 3000,
            "enabled": true,
            "ifCodeName": "Configurar parámetros del sensor",
            "id": "sensorDef",
            "description": "Configuración por defecto del sensor"
        },
        {
            "tool": "dut",
            "command": "usartXfer",
            "txCommand": "clntdef",
            "onOk": "0",
            "onErr": "1",
            "messageOnOk": "Configuración del cliente por defecto OK",
            "messageOnErr": "Configuración del cliente por defecto ERROR",
            "retry": true,
            "end": true,
            "timeout": 3000,
            "enabled": true,
            "ifCodeName": "Configurar parámetros del cliente",
            "id": "clientDef",
            "description": "Configuración por defecto del cliente"
        },
        {
            "tool": "dut",
            "command": "usartXfer",
            "txCommand": "setchmask",
            "txParameter": "0:255",
            "onOk": "0",
            "onErr": "1",
            "messageOnOk": "Configuración de canales por defecto OK",
            "messageOnErr": "Configuración de canales por defecto ERROR",
            "retry": true,
            "end": true,
            "timeout": 3000,
            "enabled": true,
            "ifCodeName": "Configurar parámetros de canales",
            "id": "chmask",
            "description": "Configuración por defecto de los canales LoRa"
        },
        {
            "tool": "app",
            "command": "loraserverapi",
            "txCommand": "create",
            "txParameter": "#serialNumber",
            "retry": true,
            "end": false,
            "timeout": 3000,
            "enabled": true,
            "ifCodeName": "Agregar medidor al sistema",
            "id": "loraserverapi",
            "description": "Agrego el medidor al sistema para poder probar la comunicación"
        },
        {
            "tool": "dut",
            "command": "usartXfer",
            "txCommand": "test_lora",
            "onOk": "0",
            "onErr": "1",
            "messageOnOk": "Prueba de interfaz de comunicación OK",
            "messageOnErr": "Prueba de interfaz de comunicación ERROR",
            "retry": true,
            "end": false,
            "timeout": 25000,
            "enabled": true,
            "ifCodeName": "Probar comunicación LoRa",
            "id": "testLora",
            "description": "Chequeo de la conexión del medidor a través de LoRa"
        },
        {
            "tool": "app",
            "command": "delay",
            "timeout": 1000,
            "enabled": true,
            "ifCodeName": "Demora de 1 segundo",
            "id": "delay",
            "description": "Demora de 1 segundo"
        },
        {
            "tool": "dut",
            "command": "usartXfer",
            "txCommand": "reset",
            "onOk": "0",
            "onErr": "1",
            "retry": true,
            "end": false,
            "timeout": 5000,
            "enabled": true,
            "ifCodeName": "Resetear el medidor",
            "id": "reset",
            "description": "Envía comando de reset al equipo"
        },
        {
            "tool": "dut",
            "command": "usartXfer",
            "txCommand": "fmode",
            "onOk": "0",
            "retry": true,
            "end": false,
            "timeout": 3000,
            "enabled": true,
            "ifCodeName": "Modo fábrica",
            "id": "fmode",
            "description": "Ingresa a modo fábrica"
        },
        {
            "tool": "dut",
            "command": "usartXfer",
            "txCommand": "getsn",
            "rxParameter": "#serialNumber",
            "onOk": "0",
            "onErr": "1",
            "messageOnOk": "Comprobación del número de serie OK",
            "messageOnErr": "Comprobación del número de serie ERROR",
            "retry": true,
            "end": false,
            "timeout": 3000,
            "enabled": true,
            "ifCodeName": "Comprobar número de serie",
            "id": "getsn",
            "description": "Lee el número de serie guardado"
        },
        {
            "tool": "dut",
            "command": "usartXfer",
            "txCommand": "version",
            "rxParameter": "v1.0.1",
            "onOk": "0",
            "onErr": "1",
            "messageOnOk": "Comprobación de la versión de firmware OK",
            "messageOnErr": "Comprobación de la versión de firmware ERROR",
            "retry": true,
            "end": false,
            "timeout": 3000,
            "enabled": true,
            "ifCodeName": "Comprobar versión de firmware",
            "id": "version",
            "description": "Lee la versión de firmware"
        },
        {
            "tool": "app",
            "command": "delay",
            "timeout": 500,
            "enabled": true,
            "ifCodeName": "Demora 500 ms",
            "id": "delay",
            "description": "Demora de 500 milisegundos"
        },
        {
            "tool": "dut",
            "command": "usartXfer",
            "txCommand": "reset",
            "onOk": "0",
            "onErr": "1",
            "retry": true,
            "end": false,
            "timeout": 5000,
            "enabled": true,
            "ifCodeName": "Resetear el medidor",
            "id": "reset",
            "description": "Envía comando de reset al equipo"
        },
        {
            "tool": "app",
            "command": "delay",
            "timeout": 1000,
            "enabled": true,
            "ifCodeName": "Demora 1 segundo",
            "id": "delay",
            "description": "Demora de 1 segundo"
        }
    ]
}